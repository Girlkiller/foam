
# 类

## 成员变量

在Java中对象的属性也称为成员变量。为了了解成员变量，首先定义一个图书类，成员变量对应于类对象的属性，在Book类中设置3个成员变量，分别为id、name和category，分别对应于图书编号、图书名称和图书类别3个图书属性。
【例7.1】在项目中创建Book类，在该类中定义并使用成员变量。

```
public class Book {
    private String name;

    //定义一个getName()方法
    public String getName() {
        //局部变量
        int id = 0;
        //调用类中其他方法
        setName("Java");
        // 设置方法返回值
        return id + this.name;
    }

    //定义一个setName()方法
    private void setName(String name) { 
        // 将参数值赋予类中的成员变量
        this.name = name; 
    }

    public Book getBook() {
        return this; //返回Book类引用
    }
}
```

根据以上代码，读者可以看到在Java中使用`class`关键字来定义类，`Book`是类的名称。同时在`Book`类中定义了3个成员变量，成员变量的类型可以设置为Java中合法的数据类型，其实成员变量就是普通的变量，可以为它设置初始值，也可以不设置初始值。如果不设置初始值，则会有默认值。读者应该注意到在3个成员变量前面的private关键字，它用来定义一个私有成员。

## 成员方法

在Java语言中使用成员方法对应于类对象的行为。以Book类为例，它包含getName()和setName()两个方法，这两个成员方法分别为获取图书名称和设置图书名称的方法。
定义成员方法的语法格式如下：

```
权限修饰符 返回值类型 方法名(参数类型 参数名) {
    ...//方法体
    return 返回值;
}
```

一个成员方法可以有参数，这个参数可以是对象，也可以是基本数据类型的变量，同时成员方法有返回值和不返回任何值的选择，如果方法需要返回值，可以在方法体中使用return关键字，使用这个关键字后，方法的执行将被终止。

**注意**
Java中的成员方法无返回值，可以使用void关键字表示。
成员方法的返回值可以是计算结果，也可以是其他想要的数值和对象，返回值类型要与方法返回的值类型一致。
在成员方法中可以调用其他成员方法和类成员变量，如在例7.1中的getName()方法中就调用了setName()方法将图书名称赋予一个值。同时在成员方法中可以定义一个变量，这个变量为局部变量。

**说明**
如果一个方法中含有与成员变量同名的局部变量，则方法中对这个变量的访问以局部变量进行。例如，变量id在getName()方法中值为0，而不是成员变量中id的值。
类成员变量和成员方法也可以统称为类成员。


**权限修饰符**
Java中的权限修饰符主要包括private、public和protected，这些修饰符控制着对类和类的成员变量以及成员方法的访问。
- 如果一个类的成员变量或成员方法被修饰为private，则该成员变量只能在本类中被使用，在子类中是不可见的，并且对其他包的类也是不可见的。
- 如果将类的成员变量和成员方法的访问权限设置为public，那么除了可以在本类使用这些数据之外，还可以在子类和其他包的类中使用。
- 如果一个类的访问权限被设置为private，这个类将隐藏其内的所有数据，以免用户直接访问它。
- 如果需要使类中的数据被子类或其他包中的类使用，可以将这个类设置为public访问权限。
- 如果一个类使用protected修饰符，那么只有本包内的该类的子类或其他类可以访问此类中的成员变量和成员方法。

这么看来，
- public和protected修饰的类可以由子类访问，
- 如果子类和父类不在同一包中，那么只有修饰符为public的类可以被子类进行访问。
- 如果父类不允许通过继承产生的子类访问它的成员变量，那么必须使用private声明父类的这个成员变量。
表7.1中描述了private、protected和public修饰符的修饰权限。


|  | 类修饰符 | 类修饰符 | 类修饰符 | 
| :--- | :---: | :---: | :---: |
| 访问包位置 |  private | protected | public |
| 本类 | 可见 | 可见 | 可见 |
| 同包其他类或子类 | 不可见 | 可见 | 可见 |
| 其他包的类或子类 | 不可见 | 不可见 | 可见

**注意**

当声明类时不使用public、protected和private修饰符设置类的权限，则这个类预设为包存取范围，即只有一个包中的类可以调用这个类的成员变量或成员方法。

```
package com.lzw;
class AnyClass {
    public void doSomething() {
        ...//方法体
    }
}
```

在上述代码中，由于类的修饰符为默认修饰符，即只有一个包内的其他类和子类可以对该类进行访问，而AnyClass类中的doString()方法却又被设置为public访问权限，即使这样，doString()方法的访问权限依然与AnyClass类的访问权限相同，因为Java语言规定，类的权限设定会约束类成员的权限设定，所以上述代码等同于如下代码。

```
package com.lzw;
class AnyClass {
    void doSomething() {
        ...//方法体
    }
}
```

**局部变量**

如果在成员方法内定义一个变量，那么这个变量被称为局部变量。

例如，在上面定义的Book类中，getName()方法的id变量即为局部变量。实际上方法中的形参也可作为一个局部变量，如在定义setName(String name)方法时，String name这个形参就被看作是局部变量。
局部变量是在方法被执行时创建，在方法执行结束时被销毁。局部变量在使用时必须进行赋值操作或被初始化，否则会出现编译错误。


**局部变量的有效范围**

可以将局部变量的有效范围称为变量的作用域，局部变量的有效范围从该变量的声明开始到该变量的结束为止。下面描述了局部变量的作用范围。

```

public void doString(String name) {
    // 局部变量id的作用范围
    int id = 0;
    for (int i = 0; i < 10; i++) {
        // 局部变量i的作用范围
        System.out.println(name + String.valueOf(i));
    }
}
```

在相互不嵌套的作用域中可以同时声明两个名称和类型相同的局部变量,
但是在相互嵌套的区域中不可以这样声明，如果将局部变量id在方法体的for循环中再次定义，编译器将会报错。

**注意**
在作用范围外使用局部变量是一个常见的错误，因为在作用范围外没有声明局部变量的代码。


## this关键字

在上述代码中可以看到，成员变量与setName()方法中的形式参数的名称相同，都为name，那么该如何在类中区分使用的是哪一个变量呢？在Java语言中规定使用this关键字来代表本类对象的引用，this关键字被隐式地用于引用对象的成员变量和方法，如在上述代码中，this.name指的就是Book类中的name成员变量，而this.name=name语句中的第二个name则指的是形参name。实质上setName()方法实现的功能就是将形参name的值赋予成员变量name。

在这里读者明白了this可以调用成员变量和成员方法，但Java语言中最常规的调用方式是使用“对象.成员变量”或“对象.成员方法”进行调用。

既然this关键字和对象都可以调用成员变量和成员方法，那么this关键字与对象之间具有怎样的关系呢？
事实上，this引用的就是本类的一个对象。在局部变量或方法参数覆盖了成员变量时，如上面代码的情况，就要添加this关键字明确引用的是类成员还是局部变量或方法参数。
如果省略this关键字直接写成name = name，那只是把参数name赋值给参数变量本身而已，成员变量name的值没有改变，因为参数name在方法的作用域中覆盖了成员变量name。
其实，this除了可以调用成员变量或成员方法之外，还可以作为方法的返回值。

在getBook()方法中，方法的返回值为Book类，所以方法体中使用return this这种形式将Book类的对象进行返回。

## 类的构造方法

在类中除了成员方法之外，还存在一种特殊类型的方法，那就是构造方法。构造方法是一个与类同名的方法，对象的创建就是通过构造方法完成的。每当类实例化一个对象时，类都会自动调用构造方法。

构造方法的特点如下：
- 构造方法没有返回值。
- 构造方法的名称要与本类的名称相同。


**注意**

在定义构造方法时，构造方法没有返回值，但这与普通没有返回值的方法不同，普通没有返回值的方法使用public void methodEx()这种形式进行定义，但构造方法并不需要使用void关键字进行修饰。
构造方法的定义语法格式如下：

```
public book() {
    ... //构造方法体
}
```
- public: 构造方法修饰符
- book: 构造方法的名称


在构造方法中可以为成员变量赋值，这样当实例化一个本类的对象时，相应的成员变量也将被初始化。
如果类中没有明确定义构造方法，编译器会自动创建一个不带参数的默认构造方法。

**注意**

- 如果在类中定义的构造方法都不是无参的构造方法，那么编译器也不会为类设置一个默认的无参构造方法，当试图调用无参构造方法实例化一个对象时，编译器会报错。
- 所以只有在类中没有定义任何构造方法时，编译器才会在该类中自动创建一个不带参数的构造方法。
- 在无参构造方法中可以使用this关键字调用有参的构造方法。但使用这种方式需要注意的是只可以在无参构造方法中的第一句使用this调用有参构造方法。


## 静态变量、常量和方法

在介绍静态变量、常量和方法之前首先需要介绍static关键字，因为由static修饰的变量、常量和方法被称作静态变量、常量和方法。
有时，在处理问题时会需要两个类在同一个内存区域共享一个数据。例如，在球类中使用PI这个常量，可能除了本类需要这个常量之外，在另外一个圆类中也需要使用这个常量。这时没有必要在两个类中同时创建PI常量，因为这样系统会将这两个不在同一个类中定义的常量分配到不同的内存空间中。为了解决这个问题，可以将这个常量设置为静态的。PI常量在内存中被共享的布局如图7.10所示。
被声明为static的变量、常量和方法被称为静态成员。静态成员属于类所有，区别于个别对象，可以在本类或其他类使用类名和“.”运算符调用静态成员。

语法如下：
类名.静态类成员


**注意**

虽然静态成员也可以使用“对象.静态成员”的形式进行调用，但通常不建议用这样的形式，因为这样容易混淆静态成员和非静态成员。
静态数据与静态方法的作用通常是为了提供共享数据或方法，如数学计算公式等，以static声明并实现，这样当需要使用时，直接使用类名调用这些静态成员即可。尽管使用这种方式调用静态成员比较方便，但静态成员同样遵循着public、private和protected修饰符的约束。


在Java语言中对静态方法有两点规定：
- 在静态方法中不可以使用this关键字。
- 在静态方法中不可以直接调用非静态方法。

**注意**

在Java中规定不能将方法体内的局部变量声明为static的


**技巧**
如果在执行类时，希望先执行类的初始化动作，可以使用static定义一个静态区域。例如：
```
public class example {
    static {
        // some
    }
} 
```
当这段代码被执行时，首先执行static块中的程序，并且只会执行一次。


## 类的主方法

主方法是类的入口点，它定义了程序从何处开始；主方法提供对程序流向的控制，Java编译器通过主方法来执行程序。主方法的语法如下：

在主方法的定义中可以看到其具有以下特性：
- 主方法是静态的，所以如要直接在主方法中调用其他方法，则该方法必须也是静态的。
- 主方法没有返回值。
- 主方法的形参为数组。其中args[0]~args[n]分别代表程序的第一个参数到第n个参数，可以使用args.length获取参数的个数。